<Page loaded="loaded" xmlns:drawer="nativescript-telerik-ui/sidedrawer" xmlns:lv="component/listview">
	<Page.actionBar>
		<ActionBar title="Groceries">
			<ActionBar.actionItems>
				<ActionItem text="Sign out" tap="signOut" ios.position="left" android:icon="res://ic_logout" />
				<ActionItem android.text="Share" tap="share" ios:icon="res://share" android:icon="res://ic_share" ios.position="right" />
			</ActionBar.actionItems>
		</ActionBar>
	</Page.actionBar>

	<drawer:SideDrawer id="drawer" drawerLocation="Right">
		<drawer:SideDrawer.drawerTransition>
			<drawer:PushTransition />
		</drawer:SideDrawer.drawerTransition>
		<drawer:SideDrawer.mainContent>
			<GridLayout rows="auto, *" id="mainContent">
				<GridLayout cssClass="topSection" row="0" columns="*, auto">
					<TextField id="grocery" text="{{ grocery }}" hint="Enter a grocery item" returnKeyType="done" col="0" />
					<Image ios:src="res://history" android:src="res://ic_recent" tap="history" col="1" />
				</GridLayout>
 
				<lv:ListView
					items="{{ groceryList }}"
					id="groceryList"
					pullToRefresh="true"
					shouldRefreshOnPull="shouldRefreshOnPull"
					selectionBehavior="Press"
					swipeCells="true"
					startSwipeCell="startSwipeCell"
					shouldSwipeCell="shouldSwipeCell"
					itemTap="itemTap"
					row="1">
					<lv:ListView.listViewLayout>
						<lv:ListViewLinearLayout itemHeight="50" itemWidth="500" />
					</lv:ListView.listViewLayout>
					<lv:ListView.itemTemplate>
						<GridLayout columns="auto, *">
							<Image src="{{ done ? 'res://checked' : 'res://unchecked' }}" cssClass="checkbox" col="0" />
							<Label text="{{ name }}" col="1" />
						</GridLayout>
					</lv:ListView.itemTemplate>
					<lv:ListView.itemSwipeTemplate>
						<GridLayout columns="60, *, 180">
							<StackLayout cssClass="swipeImageContainer doneButtonContainer" col="0">
								<Image ios:src="res://done" android:src="res://ic_done" tap="swipeDone" cssClass="swipeButton" />
							</StackLayout>
							<Placeholder col="1" />
							<StackLayout cssClass="swipeImageContainer deleteButtonContainer" col="2">
								<Image ios:src="res://delete" android:src="res://ic_delete" tap="swipeDelete" cssClass="swipeButton" col="2" />
							</StackLayout>
						</GridLayout>
					</lv:ListView.itemSwipeTemplate>
				</lv:ListView>

				<ActivityIndicator busy="{{ isLoading }}" rowSpan="2" />
			</GridLayout>
		</drawer:SideDrawer.mainContent>
		<drawer:SideDrawer.drawerContent>
			<GridLayout rows="auto, *, auto" id="drawerContent">
				<Label text="Add recent items" cssClass="heading" row="0" />
				<lv:ListView id="history" items="{{ history }}" row="1">
					<lv:ListView.listViewLayout>
						<lv:ListViewLinearLayout itemHeight="50" itemWidth="500" />
					</lv:ListView.listViewLayout>
					<lv:ListView.itemTemplate>
						<StackLayout orientation="horizontal">
							<Image src="{{ done ? 'res://selected' : 'res://add-to-groceries' }}" tap="toggleHistory" cssClass="addButton" />
							<Label text="{{ name }}" />
						</StackLayout>
					</lv:ListView.itemTemplate>
				</lv:ListView>
				<Button text="Add to the groceries list" tap="addFromHistory" cssClass="addAllButton" row="2" />
				<ActivityIndicator busy="{{ isHistoryLoading }}"
					rowSpan="3" />
			</GridLayout>
		</drawer:SideDrawer.drawerContent>
	</drawer:SideDrawer>
</Page>